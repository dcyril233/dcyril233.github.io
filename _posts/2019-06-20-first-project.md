---
title: 取石头小游戏
author: Chunyu
layout: post
categories: [project]
---
记录一下第一次用Python中的PYQT5模块写界面的经历。

我的目的是做一款玩家和电脑对抗的取石头游戏。游戏描述为：设定游戏中有三堆石子，每堆石子的数量由玩家决定，玩家在选择先手或者后者之后，与电脑依次拾取石子，每一次只能选定某一堆石子，在其中拾取任意大于零小于当前石子数的数量，拿走最后一块石子的一方获胜。

我的设计是做三个界面：菜单界面、设置界面和游戏界面。  
菜单界面提供的功能有：  
1.跳转到设置界面  
2.看游戏规则  
3.关于按钮（链接到我的主页）

设置界面提供的功能有：  
1.设置先手后手  
2.设置每个石头堆的数量  
3.跳转到游戏界面

游戏界面里会显示玩家上一步的拾取结果和现在所面临的三堆石头数。

首先我现在QT里面绘制了设置页面和游戏界面（菜单界面很简单直接用代码实现比较方便），在VSCode里面可以直接用compile form转化为py文件。在游戏的设置过程中，我主要用到的PYQT5的功能有：按键，选项，弹出的box窗口和linedit文本输入框。这个游戏的算法实现非常简单，机器人只要不断的去寻找必赢局面，既三堆石子的数量异或之后为零的局面就可以获胜。最后将算法与ui结合起来游戏就设计结束。

在ui的设计过程中我遇到了一个比较值得记录的问题。我使用了setValidator来限制文本输入框只能输入整型，而且还限制了范围。游戏的要求是轮到玩家取石子的时候，不允许选择数量为0，但是setValidator即使设置了下限为1，实际操作的时候还是能输入0。我认为这是因为在玩家输入0之后，setValidator无法进行判断玩家是要输入01、02或者是其它大于0的数字。它并不是像单片机那样可以定时跳入另一个进程来判断目前的输入合不合理，而是一开始就设计好了允许输入的规则，因此它无法拒绝玩家仅仅输入0，否则它会因此拒绝调更多合法的输入。对这个问题我的解决办法是使用if单独判断玩家的输入是否为0，如果为0提出警告并要玩家重新输入。

在做这个游戏的过程中，我还学习到了一些Python编程的知识，比如在这个project中一直用到的类，虽然理解得还很肤浅，不过熟悉了很多，使用了类之后的代码变得更有结构性，这个项目的设计思路也可以直接通过类的名字得到体现。另外我还学习了try···except···的用法，在这个游戏里这个判断非常的有用，帮我识别了输入不合法的情况，避免了进程的崩溃。